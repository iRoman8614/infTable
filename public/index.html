<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–í–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å –ª–æ–≥–∏–∫–æ–π up/down</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f5f5f5;
    }
    h1 {
      color: #333;
      margin-bottom: 20px;
    }
    virtualized-table {
      background: white;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .status {
      background: #e8f4fd;
      padding: 10px;
      border-radius: 4px;
      margin-bottom: 20px;
      font-size: 14px;
    }
    .direction-info {
      background: #d1ecf1;
      border: 1px solid #bee5eb;
      color: #0c5460;
      padding: 10px;
      border-radius: 4px;
      margin-bottom: 20px;
    }
    .controls {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      padding: 15px;
      border-radius: 4px;
      margin-bottom: 20px;
    }
    .control-button {
      background: #007bff;
      color: white;
      border: none;
      padding: 8px 16px;
      margin: 5px;
      border-radius: 4px;
      cursor: pointer;
    }
    .control-button:hover {
      background: #0056b3;
    }
    .direction-indicator {
      display: inline-block;
      padding: 4px 8px;
      margin: 0 5px;
      border-radius: 3px;
      font-size: 12px;
      font-weight: bold;
    }
    .direction-up {
      background: #d4edda;
      color: #155724;
    }
    .direction-down {
      background: #cce7ff;
      color: #004085;
    }
  </style>
</head>
<body>
<h1>–í–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–æ–π –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π</h1>

<virtualized-table
        max-width="100%"
        max-height="600px"
        scroll-batch-size="14"
        debug="true">
</virtualized-table>

<script>
  function updateDebugInfo() {
    const statusDiv = document.getElementById('handlers-status');
    if (statusDiv) {
      const hasHp = typeof window.hp === 'function';
      const hasDp = typeof window.dp === 'function';
      const hasOnTableCellClick = typeof window.onTableCellClick === 'function';

      statusDiv.innerHTML = `
        <div>window.hp: ${hasHp ? '‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω' : '‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}</div>
        <div>window.dp: ${hasDp ? '‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω' : '‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}</div>
        <div>window.onTableCellClick: ${hasOnTableCellClick ? '‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω' : '‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}</div>
        <div>–í—Ä–µ–º—è: ${new Date().toLocaleTimeString()}</div>
      `;
    }
  }

  // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∫–∞–∂–¥—ã–µ 500–º—Å
  setInterval(updateDebugInfo, 500);

  // 1. Async –ø—Ä–æ–≤–∞–π–¥–µ—Ä –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
  window.hp = async function() {
    console.log('[ASYNC HP] –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤...');

    await new Promise(resolve => setTimeout(resolve, 100));

    console.log('[ASYNC HP] –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
    return {
      "headers": [
        {
          "id": "factory1",
          "parentId": null,
          "type": "node",
          "name": "–ó–∞–≤–æ–¥ ‚Ññ1 '–ú–µ—Ç–∞–ª–ª—É—Ä–≥'",
          "metadata": {
            "color": "#343434",
            "tooltip": "–û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å",
            "workCount": 150
          }
        },
        {
          "id": "workshop1",
          "parentId": "factory1",
          "type": "assembly",
          "name": "–¶–µ—Ö —Å–±–æ—Ä–∫–∏ ‚Ññ1",
          "metadata": {
            "color": "#4caf50",
            "tooltip": "–û—Å–Ω–æ–≤–Ω–æ–π —Å–±–æ—Ä–æ—á–Ω—ã–π —Ü–µ—Ö",
            "workCount": 45
          }
        },
        {
          "id": "line1",
          "parentId": "workshop1",
          "type": "component",
          "name": "–õ–∏–Ω–∏—è –ê",
          "metadata": {
            "color": "#ff9800",
            "tooltip": "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–∏–Ω–∏—è —Å–±–æ—Ä–∫–∏",
            "workCount": 15
          }
        },
        {
          "id": "station1",
          "parentId": "line1",
          "type": "component",
          "name": "–°—Ç–∞–Ω—Ü–∏—è 1",
          "metadata": {
            "color": "#f44336",
            "tooltip": "–ù–∞—á–∞–ª—å–Ω–∞—è —Å—Ç–∞–Ω—Ü–∏—è —Å–±–æ—Ä–∫–∏",
            "workCount": 3
          }
        },
        {
          "id": "station2",
          "parentId": "line1",
          "type": "component",
          "name": "–°—Ç–∞–Ω—Ü–∏—è 2",
          "metadata": {
            "color": "#f44336",
            "tooltip": "–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è —Å—Ç–∞–Ω—Ü–∏—è",
            "workCount": 4
          }
        },
        {
          "id": "station3",
          "parentId": "line1",
          "type": "component",
          "name": "–°—Ç–∞–Ω—Ü–∏—è 3",
          "metadata": {
            "color": "#f44336",
            "tooltip": "–§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞–Ω—Ü–∏—è",
            "workCount": 5
          }
        },
        {
          "id": "line2",
          "parentId": "workshop1",
          "type": "component",
          "name": "–õ–∏–Ω–∏—è –ë",
          "metadata": {
            "color": "#ff9800",
            "tooltip": "–ü–æ–ª—É–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ª–∏–Ω–∏—è",
            "workCount": 12
          }
        },
        {
          "id": "station4",
          "parentId": "line2",
          "type": "component",
          "name": "–°—Ç–∞–Ω—Ü–∏—è 4",
          "metadata": {
            "color": "#f44336",
            "tooltip": "–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—Ç–∞–Ω—Ü–∏—è",
            "workCount": 2
          }
        },
        {
          "id": "station5",
          "parentId": "line2",
          "type": "component",
          "name": "–°—Ç–∞–Ω—Ü–∏—è 5",
          "metadata": {
            "color": "#f44336",
            "tooltip": "–£–ø–∞–∫–æ–≤–æ—á–Ω–∞—è —Å—Ç–∞–Ω—Ü–∏—è",
            "workCount": 3
          }
        },
        {
          "id": "workshop2",
          "parentId": "factory1",
          "type": "assembly",
          "name": "–¶–µ—Ö –º–µ—Ö–∞–Ω–æ–æ–±—Ä–∞–±–æ—Ç–∫–∏",
          "metadata": {
            "color": "#4caf50",
            "tooltip": "–¶–µ—Ö –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–µ—Ç–∞–ª–µ–π",
            "workCount": 65
          }
        },
        {
          "id": "section1",
          "parentId": "workshop2",
          "type": "component",
          "name": "–£—á–∞—Å—Ç–æ–∫ —Ç–æ–∫–∞—Ä–Ω—ã—Ö —Ä–∞–±–æ—Ç",
          "metadata": {
            "color": "#9c27b0",
            "tooltip": "–£—á–∞—Å—Ç–æ–∫ —Ç–æ–∫–∞—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏",
            "workCount": 25
          }
        },
        {
          "id": "machine1",
          "parentId": "section1",
          "type": "component",
          "name": "–°—Ç–∞–Ω–æ–∫ –ß–ü–£-1",
          "metadata": {
            "color": "#795548",
            "tooltip": "–¢–æ–∫–∞—Ä–Ω—ã–π —Å—Ç–∞–Ω–æ–∫ —Å –ß–ü–£",
            "workCount": 1
          }
        },
        {
          "id": "machine2",
          "parentId": "section1",
          "type": "component",
          "name": "–°—Ç–∞–Ω–æ–∫ –ß–ü–£-2",
          "metadata": {
            "color": "#795548",
            "tooltip": "–§—Ä–µ–∑–µ—Ä–Ω—ã–π —Å—Ç–∞–Ω–æ–∫ —Å –ß–ü–£",
            "workCount": 1
          }
        },
        {
          "id": "factory2",
          "parentId": null,
          "type": "node",
          "name": "–ó–∞–≤–æ–¥ ‚Ññ2 '–≠–ª–µ–∫—Ç—Ä–æ–Ω'",
          "metadata": {
            "color": "#3f51b5",
            "tooltip": "–ó–∞–≤–æ–¥ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤",
            "workCount": 120
          }
        },
        {
          "id": "workshop3",
          "parentId": "factory2",
          "type": "assembly",
          "name": "–¶–µ—Ö –ø–µ—á–∞—Ç–Ω—ã—Ö –ø–ª–∞—Ç",
          "metadata": {
            "color": "#00bcd4",
            "tooltip": "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –ø–µ—á–∞—Ç–Ω—ã—Ö –ø–ª–∞—Ç",
            "workCount": 35
          }
        },
        {
          "id": "pcb_line1",
          "parentId": "workshop3",
          "type": "component",
          "name": "–õ–∏–Ω–∏—è –ü–ü-1",
          "metadata": {
            "color": "#e91e63",
            "tooltip": "–õ–∏–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –ø–µ—á–∞—Ç–Ω—ã—Ö –ø–ª–∞—Ç",
            "workCount": 8
          }
        },
        {
          "id": "pcb_line2",
          "parentId": "workshop3",
          "type": "component",
          "name": "–õ–∏–Ω–∏—è –ü–ü-2",
          "metadata": {
            "color": "#e91e63",
            "tooltip": "–õ–∏–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ —Å–ª–æ–∂–Ω—ã—Ö –ø–ª–∞—Ç",
            "workCount": 6
          }
        }
      ]
    }
  };

  // 2. Async –ø—Ä–æ–≤–∞–π–¥–µ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–æ–π up/down
  // window.dp = async function(startDate, direction, batchSize) {
  //   const directionText = direction === 'up' ? '–¥–∞—Ç—ã —Ä–∞–Ω—å—à–µ (–≤–≤–µ—Ä—Ö)' : '–¥–∞—Ç—ã –ø–æ–∑–∂–µ (–≤–Ω–∏–∑)';
  //   console.log(`[ASYNC DP] –ó–∞–ø—Ä–æ—Å: ${startDate}, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: ${direction} (${directionText}), —Ä–∞–∑–º–µ—Ä: ${batchSize}`);
  //
  //   await new Promise(resolve => setTimeout(resolve, 250));
  //
  //   const headerIds = ["station1", "station2", "station3", "station4", "station5"];
  //   const values = ["–ú", "–û", "–ü", "–†"];
  //
  //   const [day, month, year] = startDate.split('.').map(Number);
  //   const baseDate = new Date(Date.UTC(year, month - 1, day));
  //
  //   const data = [];
  //
  //   let startDay = 0;
  //   let endDay = batchSize;
  //
  //   if (direction === 'up') {
  //     startDay = -batchSize;
  //     endDay = 0;
  //   }
  //
  //   for (let i = startDay; i < endDay; i++) {
  //     const currentDate = new Date(baseDate);
  //     currentDate.setUTCDate(baseDate.getUTCDate() + i);
  //
  //     const dateStr = currentDate.toLocaleDateString('ru-RU', {
  //       day: '2-digit',
  //       month: '2-digit',
  //       year: 'numeric'
  //     });
  //
  //     const columns = headerIds.map(headerId => ({
  //       headerId: headerId,
  //       value: values[Math.floor(Math.random() * values.length)]
  //     }));
  //
  //     data.push({
  //       date: dateStr,
  //       columns: columns
  //     });
  //   }
  //
  //   console.log("data", data)
  //
  //   if (direction === 'up') {
  //     data.sort((a, b) => {
  //       const [dayA, monthA, yearA] = a.date.split('.').map(Number);
  //       const [dayB, monthB, yearB] = b.date.split('.').map(Number);
  //       const dateA = new Date(yearA, monthA - 1, dayA);
  //       const dateB = new Date(yearB, monthB - 1, dayB);
  //       return dateA - dateB;
  //     });
  //   }
  //
  //   console.log("data2up", data)
  //
  //   console.log(`[ASYNC DP] –í–æ–∑–≤—Ä–∞—â–µ–Ω–æ ${data.length} –∑–∞–ø–∏—Å–µ–π (${directionText}), data (${data})`);
  //   return { data };
  // };
  window.dp = async function(startDate, direction, batchSize) {
    //
    return {
      "data": [
        {
          "date": "10.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ú"
            },
            {
              "headerId": "station2",
              "value": "–û"
            },
            {
              "headerId": "station3",
              "value": "–ü"
            },
            {
              "headerId": "station4",
              "value": "–†"
            },
            {
              "headerId": "station5",
              "value": "–ü"
            }
          ]
        },
        {
          "date": "11.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ú"
            },
            {
              "headerId": "station2",
              "value": "–†"
            },
            {
              "headerId": "station3",
              "value": "–ú"
            },
            {
              "headerId": "station4",
              "value": "–û"
            },
            {
              "headerId": "station5",
              "value": "–ü"
            }
          ]
        },
        {
          "date": "12.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–†"
            },
            {
              "headerId": "station2",
              "value": "–ü"
            },
            {
              "headerId": "station3",
              "value": "–ü"
            },
            {
              "headerId": "station4",
              "value": "–ú"
            },
            {
              "headerId": "station5",
              "value": "–û"
            }
          ]
        },
        {
          "date": "13.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–†"
            },
            {
              "headerId": "station2",
              "value": "–†"
            },
            {
              "headerId": "station3",
              "value": "–†"
            },
            {
              "headerId": "station4",
              "value": "–ú"
            },
            {
              "headerId": "station5",
              "value": "–†"
            }
          ]
        },
        {
          "date": "14.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ú"
            },
            {
              "headerId": "station2",
              "value": "–û"
            },
            {
              "headerId": "station3",
              "value": "–ü"
            },
            {
              "headerId": "station4",
              "value": "–†"
            },
            {
              "headerId": "station5",
              "value": "–ü"
            }
          ]
        },
        {
          "date": "15.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ü"
            },
            {
              "headerId": "station2",
              "value": "–ú"
            },
            {
              "headerId": "station3",
              "value": "–†"
            },
            {
              "headerId": "station4",
              "value": "–ü"
            },
            {
              "headerId": "station5",
              "value": "–†"
            }
          ]
        },
        {
          "date": "16.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ü"
            },
            {
              "headerId": "station2",
              "value": "–ú"
            },
            {
              "headerId": "station3",
              "value": "–†"
            },
            {
              "headerId": "station4",
              "value": "–ü"
            },
            {
              "headerId": "station5",
              "value": "–†"
            }
          ]
        },
        {
          "date": "17.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ü"
            },
            {
              "headerId": "station2",
              "value": "–ú"
            },
            {
              "headerId": "station3",
              "value": "–†"
            },
            {
              "headerId": "station4",
              "value": "–ü"
            },
            {
              "headerId": "station5",
              "value": "–†"
            }
          ]
        },
        {
          "date": "18.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ü"
            },
            {
              "headerId": "station2",
              "value": "–ú"
            },
            {
              "headerId": "station3",
              "value": "–†"
            },
            {
              "headerId": "station4",
              "value": "–ü"
            },
            {
              "headerId": "station5",
              "value": "–†"
            }
          ]
        },
        {
          "date": "19.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ü"
            },
            {
              "headerId": "station2",
              "value": "–ú"
            },
            {
              "headerId": "station3",
              "value": "–†"
            },
            {
              "headerId": "station4",
              "value": "–ü"
            },
            {
              "headerId": "station5",
              "value": "–†"
            }
          ]
        },
        {
          "date": "20.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ü"
            },
            {
              "headerId": "station2",
              "value": "–ú"
            },
            {
              "headerId": "station3",
              "value": "–†"
            },
            {
              "headerId": "station4",
              "value": "–ü"
            },
            {
              "headerId": "station5",
              "value": "–†"
            }
          ]
        },
        {
          "date": "21.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ü"
            },
            {
              "headerId": "station2",
              "value": "–ú"
            },
            {
              "headerId": "station3",
              "value": "–†"
            },
            {
              "headerId": "station4",
              "value": "–ü"
            },
            {
              "headerId": "station5",
              "value": "–†"
            }
          ]
        },
        {
          "date": "22.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ü"
            },
            {
              "headerId": "station2",
              "value": "–ú"
            },
            {
              "headerId": "station3",
              "value": "–†"
            },
            {
              "headerId": "station4",
              "value": "–ü"
            },
            {
              "headerId": "station5",
              "value": "–†"
            }
          ]
        },
        {
          "date": "23.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ü"
            },
            {
              "headerId": "station2",
              "value": "–ú"
            },
            {
              "headerId": "station3",
              "value": "–†"
            },
            {
              "headerId": "station4",
              "value": "–ü"
            },
            {
              "headerId": "station5",
              "value": "–†"
            }
          ]
        },
        {
          "date": "24.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ü"
            },
            {
              "headerId": "station2",
              "value": "–ú"
            },
            {
              "headerId": "station3",
              "value": "–†"
            },
            {
              "headerId": "station4",
              "value": "–ü"
            },
            {
              "headerId": "station5",
              "value": "–†"
            }
          ]
        },
        {
          "date": "25.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ü"
            },
            {
              "headerId": "station2",
              "value": "–ú"
            },
            {
              "headerId": "station3",
              "value": "–†"
            },
            {
              "headerId": "station4",
              "value": "–ü"
            },
            {
              "headerId": "station5",
              "value": "–†"
            }
          ]
        },
        {
          "date": "26.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ü"
            },
            {
              "headerId": "station2",
              "value": "–ú"
            },
            {
              "headerId": "station3",
              "value": "–†"
            },
            {
              "headerId": "station4",
              "value": "–ü"
            },
            {
              "headerId": "station5",
              "value": "–†"
            }
          ]
        },
        {
          "date": "27.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ü"
            },
            {
              "headerId": "station2",
              "value": "–ú"
            },
            {
              "headerId": "station3",
              "value": "–†"
            },
            {
              "headerId": "station4",
              "value": "–ü"
            },
            {
              "headerId": "station5",
              "value": "–†"
            }
          ]
        },
        {
          "date": "28.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ü"
            },
            {
              "headerId": "station2",
              "value": "–ú"
            },
            {
              "headerId": "station3",
              "value": "–†"
            },
            {
              "headerId": "station4",
              "value": "–ü"
            },
            {
              "headerId": "station5",
              "value": "–†"
            }
          ]
        },
        {
          "date": "29.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ü"
            },
            {
              "headerId": "station2",
              "value": "–ú"
            },
            {
              "headerId": "station3",
              "value": "–†"
            },
            {
              "headerId": "station4",
              "value": "–ü"
            },
            {
              "headerId": "station5",
              "value": "–†"
            }
          ]
        },
        {
          "date": "30.09.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ü"
            },
            {
              "headerId": "station2",
              "value": "–ú"
            },
            {
              "headerId": "station3",
              "value": "–†"
            },
            {
              "headerId": "station4",
              "value": "–ü"
            },
            {
              "headerId": "station5",
              "value": "–†"
            }
          ]
        },
        {
          "date": "01.10.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ú"
            },
            {
              "headerId": "station2",
              "value": "–û"
            },
            {
              "headerId": "station3",
              "value": "–ü"
            },
            {
              "headerId": "station4",
              "value": "–†"
            },
            {
              "headerId": "station5",
              "value": "–ü"
            }
          ]
        },
        {
          "date": "02.10.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ú"
            },
            {
              "headerId": "station2",
              "value": "–û"
            },
            {
              "headerId": "station3",
              "value": "–ü"
            },
            {
              "headerId": "station4",
              "value": "–†"
            },
            {
              "headerId": "station5",
              "value": "–ü"
            }
          ]
        },
        {
          "date": "03.10.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ú"
            },
            {
              "headerId": "station2",
              "value": "–û"
            },
            {
              "headerId": "station3",
              "value": "–ü"
            },
            {
              "headerId": "station4",
              "value": "–†"
            },
            {
              "headerId": "station5",
              "value": "–ü"
            }
          ]
        },
        {
          "date": "04.10.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ú"
            },
            {
              "headerId": "station2",
              "value": "–û"
            },
            {
              "headerId": "station3",
              "value": "–ü"
            },
            {
              "headerId": "station4",
              "value": "–†"
            },
            {
              "headerId": "station5",
              "value": "–ü"
            }
          ]
        },
        {
          "date": "05.10.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ú"
            },
            {
              "headerId": "station2",
              "value": "–û"
            },
            {
              "headerId": "station3",
              "value": "–ü"
            },
            {
              "headerId": "station4",
              "value": "–†"
            },
            {
              "headerId": "station5",
              "value": "–ü"
            }
          ]
        },
        {
          "date": "06.10.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ú"
            },
            {
              "headerId": "station2",
              "value": "–û"
            },
            {
              "headerId": "station3",
              "value": "–ü"
            },
            {
              "headerId": "station4",
              "value": "–†"
            },
            {
              "headerId": "station5",
              "value": "–ü"
            }
          ]
        },
        {
          "date": "07.10.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ú"
            },
            {
              "headerId": "station2",
              "value": "–û"
            },
            {
              "headerId": "station3",
              "value": "–ü"
            },
            {
              "headerId": "station4",
              "value": "–†"
            },
            {
              "headerId": "station5",
              "value": "–ü"
            }
          ]
        },
        {
          "date": "08.10.2025",
          "columns": [
            {
              "headerId": "station1",
              "value": "–ú"
            },
            {
              "headerId": "station2",
              "value": "–û"
            },
            {
              "headerId": "station3",
              "value": "–ü"
            },
            {
              "headerId": "station4",
              "value": "–†"
            },
            {
              "headerId": "station5",
              "value": "–ü"
            }
          ]
        },
      ]
    }
  };


  // 3. Async –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
  // window.onTableCellClick = async function(cellData) {
  //   const statusNames = {
  //     '–ú': '–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è',
  //     '–û': '–û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω',
  //     '–ü': '–ü—Ä–æ—Å—Ç–æ–π',
  //     '–†': '–†–∞–±–æ—Ç–∞–µ—Ç'
  //   };
  //
  //   console.log(`[ASYNC –ö–õ–ò–ö] –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º: ${cellData.date} / ${cellData.nodeId} / ${cellData.value} (${statusNames[cellData.value] || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'})`);
  //
  //   try {
  //     await new Promise(resolve => setTimeout(resolve, 300));
  //
  //     const result = {
  //       processed: true,
  //       timestamp: new Date().toISOString(),
  //       cellInfo: {
  //         date: cellData.date,
  //         nodeId: cellData.nodeId,
  //         value: cellData.value,
  //         statusName: statusNames[cellData.value] || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'
  //       }
  //     };
  //
  //     console.log('[ASYNC –ö–õ–ò–ö] –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏:', result);
  //     return result;
  //
  //   } catch (error) {
  //     console.error('[ASYNC –ö–õ–ò–ö] –û—à–∏–±–∫–∞:', error);
  //     throw error;
  //   }
  // };


  //–≤–∞—Ä–∏–≤–∞–Ω—Ç 2
  window.onTableCellClick = async function(cellData) {
    console.log(`[ASYNC –ö–õ–ò–ö] –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º: ${cellData.date} / ${cellData.nodeId}`);

    try {
      await new Promise(resolve => setTimeout(resolve, 300));

      const result = {
        date: cellData.date,
        columnId: cellData.nodeId
      };

      console.log('[ASYNC –ö–õ–ò–ö] –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏:', result);
      return result;

    } catch (error) {
      console.error('[ASYNC –ö–õ–ò–ö] –û—à–∏–±–∫–∞:', error);
      throw error;
    }
  };

  window.onTableCellClick = async function(cellData) {
    console.log(`üéØ [CLICK HANDLER] –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–ª–∏–∫:`, cellData);
    updateDebugInfo(); // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–ª–∞–¥–∫—É

    try {
      await new Promise(resolve => setTimeout(resolve, 300));

      const result = {
        date: cellData.date,
        columnId: cellData.nodeId
      };

      console.log('‚úÖ [CLICK HANDLER] –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏:', result);
      return result;

    } catch (error) {
      console.error('‚ùå [CLICK HANDLER] –û—à–∏–±–∫–∞:', error);
      throw error;
    }
  };

  // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
  const script = document.createElement('script');
  script.src = '../dist/virtualized-table.js'; // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ø—É—Ç—å

  script.onerror = function() {
    console.error('[HTML] ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞');

    document.querySelector('virtualized-table').innerHTML = `
        <div style="padding: 20px; text-align: center; color: #721c24; background: #f8d7da; border: 1px solid #f5c6cb; border-radius: 4px;">
          <h3>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞</h3>
          <p>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª virtualized-table.js</p>
          <p><small>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω —Å–æ–±—Ä–∞–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</small></p>
        </div>
      `;
  };

  document.head.appendChild(script);
</script>
</body>
</html>