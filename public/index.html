<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="utf-8" />-->
<!--  <meta name="viewport" content="width=device-width, initial-scale=1" />-->
<!--  <title>Enhanced Virtualized Table - Test with Cell Clicks</title>-->
<!--  <style>-->
<!--    .debug-info {-->
<!--      background: #f8f9fa;-->
<!--      padding: 10px;-->
<!--      margin: 10px 0;-->
<!--      border-radius: 4px;-->
<!--      font-family: monospace;-->
<!--      font-size: 12px;-->
<!--      border: 1px solid #e9ecef;-->
<!--    }-->
<!--    .provider-info {-->
<!--      background: #e3f2fd;-->
<!--      padding: 15px;-->
<!--      margin: 10px 0;-->
<!--      border-radius: 4px;-->
<!--      font-family: Arial, sans-serif;-->
<!--      font-size: 14px;-->
<!--      border: 1px solid #2196f3;-->
<!--    }-->
<!--    .provider-info h3 {-->
<!--      margin: 0 0 10px 0;-->
<!--      color: #1976d2;-->
<!--    }-->
<!--    .controls {-->
<!--      margin: 20px 0;-->
<!--      padding: 15px;-->
<!--      background: #f5f5f5;-->
<!--      border-radius: 4px;-->
<!--      border: 1px solid #ddd;-->
<!--    }-->
<!--    .controls button {-->
<!--      margin: 5px;-->
<!--      padding: 8px 16px;-->
<!--      background: #007bff;-->
<!--      color: white;-->
<!--      border: none;-->
<!--      border-radius: 4px;-->
<!--      cursor: pointer;-->
<!--    }-->
<!--    .controls button:hover {-->
<!--      background: #0056b3;-->
<!--    }-->
<!--    .click-log {-->
<!--      background: #fff3cd;-->
<!--      border: 1px solid #ffeaa7;-->
<!--      border-radius: 4px;-->
<!--      padding: 10px;-->
<!--      margin: 10px 0;-->
<!--      max-height: 200px;-->
<!--      overflow-y: auto;-->
<!--      font-family: monospace;-->
<!--      font-size: 12px;-->
<!--    }-->
<!--  </style>-->
<!--</head>-->
<!--<body>-->
<!--<h1>–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∫–ª–∏–∫–æ–≤</h1>-->

<!--<div class="provider-info">-->
<!--  <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:</h3>-->
<!--  <div><strong>–ó–∞–≥–æ–ª–æ–≤–∫–∏:</strong> –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ —Ñ–∞–π–ª–∞ headers.js</div>-->
<!--  <div><strong>–î–∞–Ω–Ω—ã–µ:</strong> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞–º–∏ –¥–ª—è –ª–∏—Å—Ç–æ–≤—ã—Ö —É–∑–ª–æ–≤</div>-->
<!--  <div><strong>–ö–ª–∏–∫–∏:</strong> –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –ø–æ —è—á–µ–π–∫–∞–º —Å –≤—ã–≤–æ–¥–æ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</div>-->
<!--</div>-->

<!--<div class="debug-info" id="debug-info">-->
<!--  <strong>–°—Ç–∞—Ç—É—Å:</strong> <span id="status">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...</span><br>-->
<!--  <strong>–ü—Ä–æ–≤–∞–π–¥–µ—Ä –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:</strong> <span id="header-status">–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</span><br>-->
<!--  <strong>–ü—Ä–æ–≤–∞–π–¥–µ—Ä –¥–∞–Ω–Ω—ã—Ö:</strong> <span id="data-status">–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</span><br>-->
<!--  <strong>–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤:</strong> <span id="click-status">–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</span>-->
<!--</div>-->

<!--<div class="controls">-->
<!--  <button id="btn-reload" onclick="reloadTable()">–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É</button>-->
<!--  <button id="btn-toggle-debug" onclick="toggleDebug()">–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –æ—Ç–ª–∞–¥–∫—É</button>-->
<!--  <button id="btn-clear-log" onclick="clearClickLog()">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥ –∫–ª–∏–∫–æ–≤</button>-->
<!--  <button id="btn-check-headers" onclick="checkHeaders()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏</button>-->
<!--</div>-->

<!--<div class="click-log" id="click-log">-->
<!--  <strong>–õ–æ–≥ –∫–ª–∏–∫–æ–≤ –ø–æ —è—á–µ–π–∫–∞–º:</strong>-->
<!--  <div id="click-entries">–ö–ª–∏–∫–Ω–∏—Ç–µ –ø–æ –ª—é–±–æ–π —è—á–µ–π–∫–µ —Ç–∞–±–ª–∏—Ü—ã...</div>-->
<!--</div>-->

<!--<virtualized-table-->
<!--        id="table"-->
<!--        header-provider-name="Headers"-->
<!--        data-provider-name="customDataProvider"-->
<!--        on-cell-click-handler="handleCellClick"-->
<!--        max-width="100%"-->
<!--        max-height="600px"-->
<!--        scroll-batch-size="7"-->
<!--        debug="true">-->
<!--</virtualized-table>-->

<!--&lt;!&ndash; –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –í–ù–ï–®–ù–ò–• –§–ê–ô–õ–û–í &ndash;&gt;-->
<!--<script src="../src/component/Table/data/headers.js"></script>-->

<!--<script>-->
<!--  const statusEl = document.getElementById('status');-->
<!--  const headerStatusEl = document.getElementById('header-status');-->
<!--  const dataStatusEl = document.getElementById('data-status');-->
<!--  const clickStatusEl = document.getElementById('click-status');-->
<!--  const clickEntriesEl = document.getElementById('click-entries');-->

<!--  function updateStatus(message) {-->
<!--    statusEl.textContent = message;-->
<!--    console.log(`[Status] ${message}`);-->
<!--  }-->

<!--  function updateHeaderStatus(message) {-->
<!--    headerStatusEl.textContent = message;-->
<!--    console.log(`[Header Provider] ${message}`);-->
<!--  }-->

<!--  function updateDataStatus(message) {-->
<!--    dataStatusEl.textContent = message;-->
<!--    console.log(`[Data Provider] ${message}`);-->
<!--  }-->

<!--  function updateClickStatus(message) {-->
<!--    clickStatusEl.textContent = message;-->
<!--    console.log(`[Click Handler] ${message}`);-->
<!--  }-->

<!--  updateStatus('–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤...');-->

<!--  // === –ü–†–û–í–ï–†–ö–ê –ó–ê–ì–û–õ–û–í–ö–û–í ===-->
<!--  function checkHeaders() {-->
<!--    if (window.Headers && window.Headers.headers) {-->
<!--      console.log('[Headers Check] –ó–∞–≥–æ–ª–æ–≤–∫–∏ –Ω–∞–π–¥–µ–Ω—ã:', window.Headers.headers.length, '—É–∑–ª–æ–≤');-->
<!--      updateHeaderStatus(`–ó–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ —Ñ–∞–π–ª–∞ - ${window.Headers.headers.length} —É–∑–ª–æ–≤`);-->

<!--      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –≤ –∫–æ–Ω—Å–æ–ª–∏-->
<!--      const leafNodes = window.Headers.headers.filter(h =>-->
<!--              !window.Headers.headers.some(child => child.parentId === h.id)-->
<!--      );-->
<!--      console.log('[Headers Check] –õ–∏—Å—Ç–æ–≤—ã–µ —É–∑–ª—ã:', leafNodes.map(n => n.name));-->

<!--      return true;-->
<!--    } else {-->
<!--      console.log('[Headers Check] –ó–∞–≥–æ–ª–æ–≤–∫–∏ –ù–ï –Ω–∞–π–¥–µ–Ω—ã');-->
<!--      updateHeaderStatus('–ù–ï –ù–ê–ô–î–ï–ù–´ - —Ñ–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω?');-->
<!--      return false;-->
<!--    }-->
<!--  }-->

<!--  // === –£–¢–ò–õ–ò–¢–´ ===-->
<!--  function parseDateString(dateString) {-->
<!--    const [day, month, year] = dateString.split('.').map(Number);-->
<!--    return new Date(Date.UTC(year, month - 1, day));-->
<!--  }-->

<!--  function formatDate(date) {-->
<!--    return date.toLocaleDateString('ru-RU', {-->
<!--      day: '2-digit',-->
<!--      month: '2-digit',-->
<!--      year: 'numeric'-->
<!--    });-->
<!--  }-->

<!--  // === –ü–†–û–í–ê–ô–î–ï–† –î–ê–ù–ù–´–• ===-->
<!--  window.customDataProvider = async (startDate, days, leafNodes) => {-->
<!--    console.log(`[Custom Data Provider] –ó–∞–≥—Ä—É–∑–∫–∞: ${startDate}, –¥–Ω–µ–π: ${days}, –ª–∏—Å—Ç–æ–≤—ã—Ö —É–∑–ª–æ–≤: ${leafNodes.length}`);-->
<!--    updateDataStatus(`–ó–∞–≥—Ä—É–∑–∫–∞: ${startDate} (+${days} –¥–Ω–µ–π, ${leafNodes.length} –∫–æ–ª–æ–Ω–æ–∫)`);-->

<!--    // –ò–º–∏—Ç–∞—Ü–∏—è —Å–µ—Ç–µ–≤–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏-->
<!--    await new Promise(resolve => setTimeout(resolve, 300));-->

<!--    const startDateObj = parseDateString(startDate);-->
<!--    const batchData = [];-->

<!--    // –í–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è-->
<!--    const statuses = ["–ú", "–û", "–ü", "–ü–†", "–†"];-->
<!--    const getRandomStatus = () => statuses[Math.floor(Math.random() * statuses.length)];-->

<!--    for (let i = 0; i < days; i++) {-->
<!--      const currentDate = new Date(startDateObj);-->
<!--      currentDate.setUTCDate(startDateObj.getUTCDate() + i);-->
<!--      const dateStr = formatDate(currentDate);-->

<!--      const dayData = {-->
<!--        date: dateStr,-->
<!--        timestamp: Date.now()-->
<!--      };-->

<!--      // –ó–∞–ø–æ–ª–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Å–µ—Ö –ª–∏—Å—Ç–æ–≤—ã—Ö —É–∑–ª–æ–≤-->
<!--      leafNodes.forEach(node => {-->
<!--        // –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —è—á–µ–µ–∫ –±—É–¥—É—Ç '–ú', –Ω–æ –∏–Ω–æ–≥–¥–∞ –¥—Ä—É–≥–∏–µ —Å—Ç–∞—Ç—É—Å—ã –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ rowspan-->
<!--        if (Math.random() > 0.85) {-->
<!--          dayData[node.id] = getRandomStatus();-->
<!--        } else {-->
<!--          dayData[node.id] = '–ú';-->
<!--        }-->
<!--      });-->

<!--      batchData.push(dayData);-->
<!--    }-->

<!--    console.log(`[Custom Data Provider] –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ ${batchData.length} –∑–∞–ø–∏—Å–µ–π –¥–ª—è ${leafNodes.length} –∫–æ–ª–æ–Ω–æ–∫`);-->
<!--    updateDataStatus(`–ì–æ—Ç–æ–≤–æ: ${batchData.length} –∑–∞–ø–∏—Å–µ–π –¥–ª—è ${leafNodes.length} –∫–æ–ª–æ–Ω–æ–∫`);-->

<!--    return { data: batchData };-->
<!--  };-->

<!--  updateDataStatus('–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –≥–æ—Ç–æ–≤');-->

<!--  // === –û–ë–†–ê–ë–û–¢–ß–ò–ö –ö–õ–ò–ö–û–í ===-->
<!--  let clickCounter = 0;-->

<!--  window.handleCellClick = function(cellData) {-->
<!--    clickCounter++;-->
<!--    const time = new Date().toLocaleTimeString();-->

<!--    console.log(`[Click Handler] –ö–ª–∏–∫ #${clickCounter}:`, cellData);-->

<!--    // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å –≤ –ª–æ–≥-->
<!--    const entry = document.createElement('div');-->
<!--    entry.className = 'click-entry';-->
<!--    entry.innerHTML = `-->
<!--      <strong>#${clickCounter}</strong> ${time} |-->
<!--      <strong>–î–∞—Ç–∞:</strong> ${cellData.date} |-->
<!--      <strong>–£–∑–µ–ª:</strong> ${cellData.node?.name || cellData.nodeId} |-->
<!--      <strong>–ó–Ω–∞—á–µ–Ω–∏–µ:</strong> ${cellData.value}-->
<!--    `;-->

<!--    // –í—Å—Ç–∞–≤–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–æ –ª–æ–≥–∞-->
<!--    if (clickEntriesEl.children.length === 0 || clickEntriesEl.children[0].textContent.includes('–ö–ª–∏–∫–Ω–∏—Ç–µ')) {-->
<!--      clickEntriesEl.innerHTML = '';-->
<!--    }-->
<!--    clickEntriesEl.insertBefore(entry, clickEntriesEl.firstChild);-->

<!--    // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π-->
<!--    while (clickEntriesEl.children.length > 20) {-->
<!--      clickEntriesEl.removeChild(clickEntriesEl.lastChild);-->
<!--    }-->

<!--    // –ê–Ω–∞–ª–∏–∑ –∫–ª–∏–∫–∞-->
<!--    if (cellData.value === '–ú') {-->
<!--      console.log('üíö –¢–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ:', cellData.node?.name);-->
<!--    } else if (cellData.value === '–û') {-->
<!--      console.log('üü° –û—Å—Ç–∞–Ω–æ–≤–∫–∞:', cellData.node?.name);-->
<!--    } else if (cellData.value === '–ü') {-->
<!--      console.log('üü¢ –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ:', cellData.node?.name);-->
<!--    } else if (cellData.value === '–ü–†') {-->
<!--      console.log('üîµ –ü—Ä–æ—Å—Ç–æ–π:', cellData.node?.name);-->
<!--    } else if (cellData.value === '–†') {-->
<!--      console.log('üî¥ –†–µ–º–æ–Ω—Ç:', cellData.node?.name);-->
<!--    }-->
<!--  };-->

<!--  updateClickStatus('–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –≥–æ—Ç–æ–≤');-->

<!--  // === –ü–†–û–í–ï–†–ö–ê –ó–ê–ì–†–£–ó–ö–ò ===-->
<!--  function waitForHeaders() {-->
<!--    if (checkHeaders()) {-->
<!--      updateStatus('–ó–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞...');-->
<!--      return true;-->
<!--    }-->
<!--    return false;-->
<!--  }-->

<!--  // === –§–£–ù–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø ===-->
<!--  function reloadTable() {-->
<!--    const table = document.getElementById('table');-->
<!--    const parent = table.parentNode;-->
<!--    const newTable = table.cloneNode(true);-->
<!--    parent.removeChild(table);-->
<!--    parent.appendChild(newTable);-->
<!--    updateStatus('–¢–∞–±–ª–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞');-->
<!--  }-->

<!--  function toggleDebug() {-->
<!--    const table = document.getElementById('table');-->
<!--    const currentDebug = table.getAttribute('debug');-->
<!--    const newDebug = currentDebug === 'true' ? 'false' : 'true';-->
<!--    table.setAttribute('debug', newDebug);-->
<!--    updateStatus(`–û—Ç–ª–∞–¥–∫–∞: ${newDebug}`);-->
<!--  }-->

<!--  function clearClickLog() {-->
<!--    clickEntriesEl.innerHTML = '–ö–ª–∏–∫–Ω–∏—Ç–µ –ø–æ –ª—é–±–æ–π —è—á–µ–π–∫–µ —Ç–∞–±–ª–∏—Ü—ã...';-->
<!--    clickCounter = 0;-->
<!--    updateClickStatus('–õ–æ–≥ –æ—á–∏—â–µ–Ω');-->
<!--  }-->

<!--  // === –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –ó–ê–ì–†–£–ó–ö–ò ===-->
<!--  function handleScriptLoad() {-->
<!--    updateStatus('–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–µ–Ω');-->

<!--    setTimeout(() => {-->
<!--      if (customElements.get('virtualized-table')) {-->
<!--        updateStatus('Web component –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω - –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!');-->
<!--      } else {-->
<!--        updateStatus('–û–®–ò–ë–ö–ê: Web component –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω');-->
<!--      }-->
<!--    }, 500);-->
<!--  }-->

<!--  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ–±—â–∏—Ö –æ—à–∏–±–æ–∫-->
<!--  window.addEventListener('error', (e) => {-->
<!--    console.error('[Global Error]', e.error);-->
<!--    updateStatus(`–û—à–∏–±–∫–∞: ${e.message}`);-->
<!--  });-->

<!--  // –°–ª—É—à–∞–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –∫–ª–∏–∫–æ–≤-->
<!--  window.addEventListener('table-cell-click', function(event) {-->
<!--    const cellData = event.detail;-->
<!--    console.log('[Custom Event] –°–æ–±—ã—Ç–∏–µ –∫–ª–∏–∫–∞ –ø–æ —è—á–µ–π–∫–µ:', cellData);-->
<!--  });-->

<!--  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ DOM-->
<!--  if (document.readyState === 'loading') {-->
<!--    document.addEventListener('DOMContentLoaded', () => {-->
<!--      updateStatus('DOM –≥–æ—Ç–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤...');-->
<!--      setTimeout(waitForHeaders, 100);-->
<!--    });-->
<!--  } else {-->
<!--    updateStatus('DOM –≥–æ—Ç–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤...');-->
<!--    setTimeout(waitForHeaders, 100);-->
<!--  }-->

<!--  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ø—ã—Ç–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ –ø—É—Ç—è–º–∏-->
<!--  function tryLoadScript() {-->
<!--    const paths = [-->
<!--      './dist/virtualized-table.js',-->
<!--      '/dist/virtualized-table.js',-->
<!--      '../dist/virtualized-table.js',-->
<!--      'dist/virtualized-table.js',-->
<!--      './virtualized-table.js',-->
<!--      '/public/dist/virtualized-table.js',-->
<!--      './web-component-table.js'-->
<!--    ];-->

<!--    function loadWithPath(index = 0) {-->
<!--      if (index >= paths.length) {-->
<!--        updateStatus('–û–®–ò–ë–ö–ê: –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–∏ –ø–æ –æ–¥–Ω–æ–º—É –ø—É—Ç–∏');-->
<!--        return;-->
<!--      }-->

<!--      const script = document.createElement('script');-->
<!--      script.src = paths[index];-->

<!--      script.onload = () => {-->
<!--        console.log(`[Success] –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —Å –ø—É—Ç–∏: ${paths[index]}`);-->
<!--        handleScriptLoad();-->
<!--      };-->

<!--      script.onerror = () => {-->
<!--        console.log(`[Failed] –ü—É—Ç—å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç: ${paths[index]}`);-->
<!--        loadWithPath(index + 1);-->
<!--      };-->

<!--      document.head.appendChild(script);-->
<!--    }-->

<!--    loadWithPath();-->
<!--  }-->

<!--  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞-->
<!--  let checkAttempts = 0;-->
<!--  const maxAttempts = 50;-->

<!--  function checkAndLoad() {-->
<!--    checkAttempts++;-->

<!--    if (waitForHeaders()) {-->
<!--      // –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –∑–∞–ø—É—Å–∫–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞-->
<!--      tryLoadScript();-->
<!--    } else if (checkAttempts < maxAttempts) {-->
<!--      // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –æ–∂–∏–¥–∞–Ω–∏–µ-->
<!--      setTimeout(checkAndLoad, 100);-->
<!--    } else {-->
<!--      // –ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è-->
<!--      updateStatus('–û–®–ò–ë–ö–ê: –ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤');-->
<!--      updateHeaderStatus('–û–®–ò–ë–ö–ê: –§–∞–π–ª headers.js –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');-->
<!--    }-->
<!--  }-->

<!--  // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ—Ä–µ–∑ –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É-->
<!--  setTimeout(checkAndLoad, 200);-->

<!--  // –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥-->
<!--  setTimeout(() => {-->
<!--    const table = document.getElementById('table');-->
<!--    if (table && table.shadowRoot) {-->
<!--      updateStatus('–¢–∞–±–ª–∏—Ü–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ!');-->

<!--      // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è-->
<!--      setTimeout(() => {-->
<!--        if (window.Headers && window.Headers.headers) {-->
<!--          const leafNodes = window.Headers.headers.filter(h =>-->
<!--                  !window.Headers.headers.some(child => child.parentId === h.id)-->
<!--          );-->
<!--          updateStatus(`–ì–æ—Ç–æ–≤–æ! –õ–∏—Å—Ç–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–æ–∫: ${leafNodes.length}. –ö–ª–∏–∫–∞–π—Ç–µ –ø–æ —è—á–µ–π–∫–∞–º!`);-->
<!--        }-->
<!--      }, 1000);-->

<!--    } else if (table) {-->
<!--      updateStatus('–≠–ª–µ–º–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω, –Ω–æ shadow DOM –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç');-->
<!--    } else {-->
<!--      updateStatus('–û–®–ò–ë–ö–ê: –≠–ª–µ–º–µ–Ω—Ç —Ç–∞–±–ª–∏—Ü—ã –Ω–µ –Ω–∞–π–¥–µ–Ω');-->
<!--    }-->
<!--  }, 5000);-->
<!--</script>-->
<!--</body>-->
<!--</html>-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Virtualized Table - Working Version</title>
</head>
<body>
<h1>–í–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞</h1>

<!-- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã -->
<script>
  console.log('[HTML] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤...');

  // === –ü–†–û–í–ê–ô–î–ï–† –ó–ê–ì–û–õ–û–í–ö–û–í ===
  window.HeadersProvider = function() {
    console.log('[HeadersProvider] –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞');

    return {
      headers: [
        {
          id: "factory1",
          parentId: null,
          name: "–ó–∞–≤–æ–¥ ‚Ññ1 '–ú–µ—Ç–∞–ª–ª—É—Ä–≥'",
          metadata: {
            color: "#343434",
            workCount: 150
          }
        },
        {
          id: "workshop1",
          parentId: "factory1",
          name: "–¶–µ—Ö —Å–±–æ—Ä–∫–∏ ‚Ññ1",
          metadata: {
            color: "#4caf50",
            workCount: 45
          }
        },
        {
          id: "line1",
          parentId: "workshop1",
          name: "–õ–∏–Ω–∏—è –ê",
          metadata: {
            color: "#ff9800",
            workCount: 15
          }
        },
        {
          id: "station1",
          parentId: "line1",
          name: "–°—Ç–∞–Ω—Ü–∏—è 1",
          metadata: {
            color: "#f44336",
            workCount: 3
          }
        },
        {
          id: "station2",
          parentId: "line1",
          name: "–°—Ç–∞–Ω—Ü–∏—è 2",
          metadata: {
            color: "#f44336",
            workCount: 4
          }
        },
        {
          id: "station3",
          parentId: "line1",
          name: "–°—Ç–∞–Ω—Ü–∏—è 3",
          metadata: {
            color: "#f44336",
            workCount: 5
          }
        },
        {
          id: "line2",
          parentId: "workshop1",
          name: "–õ–∏–Ω–∏—è –ë",
          metadata: {
            color: "#ff9800",
            workCount: 12
          }
        },
        {
          id: "station4",
          parentId: "line2",
          name: "–°—Ç–∞–Ω—Ü–∏—è 4",
          metadata: {
            color: "#f44336",
            workCount: 2
          }
        },
        {
          id: "station5",
          parentId: "line2",
          name: "–°—Ç–∞–Ω—Ü–∏—è 5",
          metadata: {
            color: "#f44336",
            workCount: 3
          }
        },
        {
          id: "workshop2",
          parentId: "factory1",
          name: "–¶–µ—Ö –º–µ—Ö–∞–Ω–æ–æ–±—Ä–∞–±–æ—Ç–∫–∏",
          metadata: {
            color: "#4caf50",
            workCount: 65
          }
        },
        {
          id: "section1",
          parentId: "workshop2",
          name: "–£—á–∞—Å—Ç–æ–∫ —Ç–æ–∫–∞—Ä–Ω—ã—Ö —Ä–∞–±–æ—Ç",
          metadata: {
            color: "#9c27b0",
            workCount: 25
          }
        },
        {
          id: "machine1",
          parentId: "section1",
          name: "–°—Ç–∞–Ω–æ–∫ –ß–ü–£-1",
          metadata: {
            color: "#795548",
            workCount: 1
          }
        },
        {
          id: "machine2",
          parentId: "section1",
          name: "–°—Ç–∞–Ω–æ–∫ –ß–ü–£-2",
          metadata: {
            color: "#795548",
            workCount: 1
          }
        },
        {
          id: "factory2",
          parentId: null,
          name: "–ó–∞–≤–æ–¥ ‚Ññ2 '–≠–ª–µ–∫—Ç—Ä–æ–Ω'",
          metadata: {
            color: "#3f51b5",
            workCount: 120
          }
        },
        {
          id: "workshop3",
          parentId: "factory2",
          name: "–¶–µ—Ö –ø–µ—á–∞—Ç–Ω—ã—Ö –ø–ª–∞—Ç",
          metadata: {
            color: "#00bcd4",
            workCount: 35
          }
        },
        {
          id: "pcb_line1",
          parentId: "workshop3",
          name: "–õ–∏–Ω–∏—è –ü–ü-1",
          metadata: {
            color: "#e91e63",
            workCount: 8
          }
        },
        {
          id: "pcb_line2",
          parentId: "workshop3",
          name: "–õ–∏–Ω–∏—è –ü–ü-2",
          metadata: {
            color: "#e91e63",
            workCount: 6
          }
        }
      ]
    };
  };

  // === –ü–†–û–í–ê–ô–î–ï–† –î–ê–ù–ù–´–• ===
  window.customDataProvider = async function(startDate, days, leafNodes) {
    console.log(`[DataProvider] –ó–∞–≥—Ä—É–∑–∫–∞: ${startDate}, –¥–Ω–µ–π: ${days}, —É–∑–ª–æ–≤: ${leafNodes.length}`);

    // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏
    await new Promise(resolve => setTimeout(resolve, 100));

    const batchData = [];
    const statuses = ["–ú", "–û", "–ü", "–ü–†", "–†"];

    // –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç—ã
    const [day, month, year] = startDate.split('.').map(Number);
    const startDateObj = new Date(year, month - 1, day);

    for (let i = 0; i < days; i++) {
      const currentDate = new Date(startDateObj);
      currentDate.setDate(startDateObj.getDate() + i);

      const dateStr = currentDate.toLocaleDateString('ru-RU', {
        day: '2-digit',
        month: '2-digit',
        year: 'numeric'
      });

      const dayData = {
        date: dateStr,
        timestamp: Date.now()
      };

      leafNodes.forEach(node => {
        dayData[node.id] = statuses[Math.floor(Math.random() * statuses.length)];
      });

      batchData.push(dayData);
    }

    return { data: batchData };
  };

  // === –û–ë–†–ê–ë–û–¢–ß–ò–ö –ö–õ–ò–ö–û–í ===
  window.handleCellClick = function(cellData) {
    console.log('[ClickHandler] –ö–ª–∏–∫ –ø–æ —è—á–µ–π–∫–µ:', cellData);
    console.log(`–î–∞—Ç–∞: ${cellData.date}, –£–∑–µ–ª: ${cellData.node?.name}, –ó–Ω–∞—á–µ–Ω–∏–µ: ${cellData.value}`);
  };

  // –°–æ–∑–¥–∞–µ–º –∞–ª–∏–∞—Å—ã –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
  window.hp = window.HeadersProvider;
  window.dp = window.customDataProvider;

  console.log('[HTML] –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:');
  console.log('- HeadersProvider:', typeof window.HeadersProvider);
  console.log('- customDataProvider:', typeof window.customDataProvider);
  console.log('- handleCellClick:', typeof window.handleCellClick);

  // –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø—Ä–æ–≤–∞–π–¥–µ—Ä –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
  try {
    const testHeaders = window.HeadersProvider();
    console.log(`[HTML] –¢–µ—Å—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞: ${testHeaders.headers.length} –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤`);
  } catch (error) {
    console.error('[HTML] –û—à–∏–±–∫–∞ –≤ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:', error);
  }
</script>

<!-- –¢–∞–±–ª–∏—Ü–∞ -->
<virtualized-table
        header-provider-name="HeadersProvider"
        data-provider-name="customDataProvider"
        on-cell-click-handler="handleCellClick"
        max-width="100%"
        max-height="600px"
        scroll-batch-size="7"
        debug="true">
</virtualized-table>

<!-- –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ -->
<script>
  console.log('[HTML] –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —Ç–∞–±–ª–∏—Ü—ã...');

  const script = document.createElement('script');
  script.src = '../dist/virtualized-table.js';

  script.onload = function() {
    console.log('[HTML] ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Ç–∞–±–ª–∏—Ü—ã –∑–∞–≥—Ä—É–∂–µ–Ω');

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ –∑–∞–¥–µ—Ä–∂–∫—É
    setTimeout(() => {
      const registered = customElements.get('virtualized-table');
      if (registered) {
        console.log('[HTML] ‚úÖ Web Component –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω');
        console.log('[HTML] üéØ –¢–∞–±–ª–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏');
      } else {
        console.error('[HTML] ‚ùå Web Component –ù–ï –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω');
      }
    }, 500);
  };

  script.onerror = function() {
    console.error('[HTML] ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞');
    console.log('[HTML] –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–∏–µ –ø—É—Ç–∏:');
    console.log('- /dist/virtualized-table.js');
    console.log('- ./dist/virtualized-table.js');
  };

  document.head.appendChild(script);
</script>

<style>
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
    background-color: #f5f5f5;
  }
  h1 {
    color: #333;
    margin-bottom: 20px;
  }
  virtualized-table {
    background: white;
    border-radius: 4px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }
</style>
</body>
</html>